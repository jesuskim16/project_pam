<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SaleMgr">
	<typeAlias alias="sdto" type="ITFree.PAM.Agent.Model.SalesMgr.SalesDto" />
	<typeAlias alias="zdto" type="ITFree.PAM.Agent.Model.SalesMgr.ZipcodeDto" />
	<typeAlias type="ITFree.PAM.Common.Model.Board.PageDto" alias="pagedto"/>

	<insert id="salesRegister_insertAction" parameterClass="sdto">
		INSERT
		INTO BRANCH(SEQ, BRC_ID, ATTACH_ID, PASSWORD, BRC_NAME, BRC_BOSS,
		BOSS_PHONE, BRC_LEV, WRITE_ID, BRC_PHONE, BRC_ADDR1, BRC_ADDR2,
		BRC_POST )
		VALUES(BRC_SEQ.nextval, #brc_id#, #attach_id#, #password#,
		#brc_name# ,#brc_boss#,
		#boss_phone#, #brc_lev#, #attach_id#,
		#brc_phone#, #brc_addr1#,
		#brc_addr2#, #brc_post#)
	</insert>

	<select id="searchZipcode" parameterClass="String" resultClass="zdto">
		SELECT substr(zipcode,1,3) as zipcode1 ,
		substr(zipcode,5,3) as
		zipcode2 ,
		trim(sido || ' ' || gugun || ' ' ||
		dong || ' ' || ri || ' '
		|| bunji) as addr1
		FROM zipcode
		WHERE dong like '%' || #dong# || '%'
	</select>

	<select id="salesInfo_list" resultClass="sdto">
		SELECT seq, brc_name, brc_id, brc_phone,
		brc_addr1, brc_addr2, brc_post,
		brc_boss, boss_phone, to_char(write_date, 'YYYY-MM-DD') AS write_date
		FROM BRANCH
		WHERE BRC_LEV='2'
		ORDER BY seq ASC
	</select>

	<update id="salesUpdate" parameterClass="sdto">
		UPDATE BRANCH SET
		brc_name=#brc_name#, brc_id=#brc_id#, brc_phone=#brc_phone#,
		brc_addr1=#brc_addr1#, brc_addr2=#brc_addr2#, brc_post=#brc_post#,
		brc_boss=#brc_boss#, boss_phone=#boss_phone#, write_date=#write_date#
		WHERE seq = #seq#
	</update>





</sqlMap>
